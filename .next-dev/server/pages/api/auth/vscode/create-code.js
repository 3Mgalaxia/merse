"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/vscode/create-code";
exports.ids = ["pages/api/auth/vscode/create-code"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "firebase-admin/app":
/*!*************************************!*\
  !*** external "firebase-admin/app" ***!
  \*************************************/
/***/ ((module) => {

module.exports = import("firebase-admin/app");;

/***/ }),

/***/ "firebase-admin/auth":
/*!**************************************!*\
  !*** external "firebase-admin/auth" ***!
  \**************************************/
/***/ ((module) => {

module.exports = import("firebase-admin/auth");;

/***/ }),

/***/ "firebase-admin/firestore":
/*!*******************************************!*\
  !*** external "firebase-admin/firestore" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = import("firebase-admin/firestore");;

/***/ }),

/***/ "firebase-admin/storage":
/*!*****************************************!*\
  !*** external "firebase-admin/storage" ***!
  \*****************************************/
/***/ ((module) => {

module.exports = import("firebase-admin/storage");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fvscode%2Fcreate-code&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fvscode%2Fcreate-code.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fvscode%2Fcreate-code&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fvscode%2Fcreate-code.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_auth_vscode_create_code_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/auth/vscode/create-code.ts */ \"(api)/./pages/api/auth/vscode/create-code.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_auth_vscode_create_code_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_auth_vscode_create_code_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_vscode_create_code_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_vscode_create_code_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/auth/vscode/create-code\",\n        pathname: \"/api/auth/vscode/create-code\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_auth_vscode_create_code_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmF1dGglMkZ2c2NvZGUlMkZjcmVhdGUtY29kZSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGYXV0aCUyRnZzY29kZSUyRmNyZWF0ZS1jb2RlLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ21FO0FBQ25FO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxrRUFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsa0VBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVyc2VlLz8yODhkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvYXV0aC92c2NvZGUvY3JlYXRlLWNvZGUudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL3ZzY29kZS9jcmVhdGUtY29kZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvdnNjb2RlL2NyZWF0ZS1jb2RlXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fvscode%2Fcreate-code&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fvscode%2Fcreate-code.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/firebaseAdmin.ts":
/*!******************************!*\
  !*** ./lib/firebaseAdmin.ts ***!
  \******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   adminDb: () => (/* binding */ adminDb),\n/* harmony export */   adminStorage: () => (/* binding */ adminStorage)\n/* harmony export */ });\n/* harmony import */ var firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase-admin/app */ \"firebase-admin/app\");\n/* harmony import */ var firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase-admin/firestore */ \"firebase-admin/firestore\");\n/* harmony import */ var firebase_admin_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! firebase-admin/storage */ \"firebase-admin/storage\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__, firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__, firebase_admin_storage__WEBPACK_IMPORTED_MODULE_2__]);\n([firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__, firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__, firebase_admin_storage__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nfunction getServiceAccount() {\n    const raw = process.env.FIREBASE_ADMIN_JSON;\n    if (raw) {\n        const txt = raw.trim().startsWith(\"{\") ? raw : Buffer.from(raw, \"base64\").toString(\"utf8\");\n        return JSON.parse(txt);\n    }\n    const projectId = process.env.FIREBASE_ADMIN_PROJECT_ID;\n    const clientEmail = process.env.FIREBASE_ADMIN_CLIENT_EMAIL;\n    const privateKeyRaw = process.env.FIREBASE_ADMIN_PRIVATE_KEY;\n    if (!projectId || !clientEmail || !privateKeyRaw) {\n        throw new Error(\"Missing FIREBASE_ADMIN_JSON or legacy Firebase admin env vars\");\n    }\n    return {\n        projectId,\n        clientEmail,\n        privateKey: privateKeyRaw.replace(/\\\\n/g, \"\\n\")\n    };\n}\nconst storageBucket = process.env.FIREBASE_ADMIN_STORAGE_BUCKET;\nconst app = (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.getApps)().length > 0 ? (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.getApps)()[0] : (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.initializeApp)({\n    credential: (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.cert)(getServiceAccount()),\n    ...storageBucket ? {\n        storageBucket\n    } : {}\n});\nconst adminDb = (0,firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__.getFirestore)(app);\nconst adminStorage = storageBucket ? (0,firebase_admin_storage__WEBPACK_IMPORTED_MODULE_2__.getStorage)(app).bucket(storageBucket) : null;\n(()=>{\n    try {\n        const globalAny = globalThis;\n        const flag = \"__merse_firestore_settings_applied__\";\n        if (!globalAny[flag]) {\n            adminDb.settings({\n                ignoreUndefinedProperties: true\n            });\n            globalAny[flag] = true;\n        }\n    } catch  {\n    // ignore if settings were already applied elsewhere\n    }\n})();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZmlyZWJhc2VBZG1pbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFrRTtBQUNWO0FBQ0o7QUFFcEQsU0FBU0s7SUFDUCxNQUFNQyxNQUFNQyxRQUFRQyxHQUFHLENBQUNDLG1CQUFtQjtJQUMzQyxJQUFJSCxLQUFLO1FBQ1AsTUFBTUksTUFBTUosSUFBSUssSUFBSSxHQUFHQyxVQUFVLENBQUMsT0FDOUJOLE1BQ0FPLE9BQU9DLElBQUksQ0FBQ1IsS0FBSyxVQUFVUyxRQUFRLENBQUM7UUFDeEMsT0FBT0MsS0FBS0MsS0FBSyxDQUFDUDtJQUNwQjtJQUVBLE1BQU1RLFlBQVlYLFFBQVFDLEdBQUcsQ0FBQ1cseUJBQXlCO0lBQ3ZELE1BQU1DLGNBQWNiLFFBQVFDLEdBQUcsQ0FBQ2EsMkJBQTJCO0lBQzNELE1BQU1DLGdCQUFnQmYsUUFBUUMsR0FBRyxDQUFDZSwwQkFBMEI7SUFFNUQsSUFBSSxDQUFDTCxhQUFhLENBQUNFLGVBQWUsQ0FBQ0UsZUFBZTtRQUNoRCxNQUFNLElBQUlFLE1BQU07SUFDbEI7SUFFQSxPQUFPO1FBQ0xOO1FBQ0FFO1FBQ0FLLFlBQVlILGNBQWNJLE9BQU8sQ0FBQyxRQUFRO0lBQzVDO0FBQ0Y7QUFFQSxNQUFNQyxnQkFBZ0JwQixRQUFRQyxHQUFHLENBQUNvQiw2QkFBNkI7QUFDL0QsTUFBTUMsTUFDSjVCLDJEQUFPQSxHQUFHNkIsTUFBTSxHQUFHLElBQ2Y3QiwyREFBT0EsRUFBRSxDQUFDLEVBQUUsR0FDWkMsaUVBQWFBLENBQUM7SUFDWjZCLFlBQVkvQix3REFBSUEsQ0FBQ0s7SUFDakIsR0FBSXNCLGdCQUFnQjtRQUFFQTtJQUFjLElBQUksQ0FBQyxDQUFDO0FBQzVDO0FBRUMsTUFBTUssVUFBVTdCLHNFQUFZQSxDQUFDMEIsS0FBSztBQUNsQyxNQUFNSSxlQUFlTixnQkFDeEJ2QixrRUFBVUEsQ0FBQ3lCLEtBQUtLLE1BQU0sQ0FBQ1AsaUJBQ3ZCLEtBQUs7QUFFUjtJQUNDLElBQUk7UUFDRixNQUFNUSxZQUFZQztRQUNsQixNQUFNQyxPQUFPO1FBQ2IsSUFBSSxDQUFDRixTQUFTLENBQUNFLEtBQUssRUFBRTtZQUNwQkwsUUFBUU0sUUFBUSxDQUFDO2dCQUFFQywyQkFBMkI7WUFBSztZQUNuREosU0FBUyxDQUFDRSxLQUFLLEdBQUc7UUFDcEI7SUFDRixFQUFFLE9BQU07SUFDTixvREFBb0Q7SUFDdEQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21lcnNlZS8uL2xpYi9maXJlYmFzZUFkbWluLnRzPzE3MWYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2VydCwgZ2V0QXBwcywgaW5pdGlhbGl6ZUFwcCB9IGZyb20gXCJmaXJlYmFzZS1hZG1pbi9hcHBcIjtcbmltcG9ydCB7IGdldEZpcmVzdG9yZSB9IGZyb20gXCJmaXJlYmFzZS1hZG1pbi9maXJlc3RvcmVcIjtcbmltcG9ydCB7IGdldFN0b3JhZ2UgfSBmcm9tIFwiZmlyZWJhc2UtYWRtaW4vc3RvcmFnZVwiO1xuXG5mdW5jdGlvbiBnZXRTZXJ2aWNlQWNjb3VudCgpIHtcbiAgY29uc3QgcmF3ID0gcHJvY2Vzcy5lbnYuRklSRUJBU0VfQURNSU5fSlNPTjtcbiAgaWYgKHJhdykge1xuICAgIGNvbnN0IHR4dCA9IHJhdy50cmltKCkuc3RhcnRzV2l0aChcIntcIilcbiAgICAgID8gcmF3XG4gICAgICA6IEJ1ZmZlci5mcm9tKHJhdywgXCJiYXNlNjRcIikudG9TdHJpbmcoXCJ1dGY4XCIpO1xuICAgIHJldHVybiBKU09OLnBhcnNlKHR4dCk7XG4gIH1cblxuICBjb25zdCBwcm9qZWN0SWQgPSBwcm9jZXNzLmVudi5GSVJFQkFTRV9BRE1JTl9QUk9KRUNUX0lEO1xuICBjb25zdCBjbGllbnRFbWFpbCA9IHByb2Nlc3MuZW52LkZJUkVCQVNFX0FETUlOX0NMSUVOVF9FTUFJTDtcbiAgY29uc3QgcHJpdmF0ZUtleVJhdyA9IHByb2Nlc3MuZW52LkZJUkVCQVNFX0FETUlOX1BSSVZBVEVfS0VZO1xuXG4gIGlmICghcHJvamVjdElkIHx8ICFjbGllbnRFbWFpbCB8fCAhcHJpdmF0ZUtleVJhdykge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgRklSRUJBU0VfQURNSU5fSlNPTiBvciBsZWdhY3kgRmlyZWJhc2UgYWRtaW4gZW52IHZhcnNcIik7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHByb2plY3RJZCxcbiAgICBjbGllbnRFbWFpbCxcbiAgICBwcml2YXRlS2V5OiBwcml2YXRlS2V5UmF3LnJlcGxhY2UoL1xcXFxuL2csIFwiXFxuXCIpLFxuICB9O1xufVxuXG5jb25zdCBzdG9yYWdlQnVja2V0ID0gcHJvY2Vzcy5lbnYuRklSRUJBU0VfQURNSU5fU1RPUkFHRV9CVUNLRVQ7XG5jb25zdCBhcHAgPVxuICBnZXRBcHBzKCkubGVuZ3RoID4gMFxuICAgID8gZ2V0QXBwcygpWzBdXG4gICAgOiBpbml0aWFsaXplQXBwKHtcbiAgICAgICAgY3JlZGVudGlhbDogY2VydChnZXRTZXJ2aWNlQWNjb3VudCgpKSxcbiAgICAgICAgLi4uKHN0b3JhZ2VCdWNrZXQgPyB7IHN0b3JhZ2VCdWNrZXQgfSA6IHt9KSxcbiAgICAgIH0pO1xuXG5leHBvcnQgY29uc3QgYWRtaW5EYiA9IGdldEZpcmVzdG9yZShhcHApO1xuZXhwb3J0IGNvbnN0IGFkbWluU3RvcmFnZSA9IHN0b3JhZ2VCdWNrZXRcbiAgPyBnZXRTdG9yYWdlKGFwcCkuYnVja2V0KHN0b3JhZ2VCdWNrZXQpXG4gIDogbnVsbDtcblxuKCgpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBnbG9iYWxBbnkgPSBnbG9iYWxUaGlzIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgIGNvbnN0IGZsYWcgPSBcIl9fbWVyc2VfZmlyZXN0b3JlX3NldHRpbmdzX2FwcGxpZWRfX1wiO1xuICAgIGlmICghZ2xvYmFsQW55W2ZsYWddKSB7XG4gICAgICBhZG1pbkRiLnNldHRpbmdzKHsgaWdub3JlVW5kZWZpbmVkUHJvcGVydGllczogdHJ1ZSB9KTtcbiAgICAgIGdsb2JhbEFueVtmbGFnXSA9IHRydWU7XG4gICAgfVxuICB9IGNhdGNoIHtcbiAgICAvLyBpZ25vcmUgaWYgc2V0dGluZ3Mgd2VyZSBhbHJlYWR5IGFwcGxpZWQgZWxzZXdoZXJlXG4gIH1cbn0pKCk7XG4iXSwibmFtZXMiOlsiY2VydCIsImdldEFwcHMiLCJpbml0aWFsaXplQXBwIiwiZ2V0RmlyZXN0b3JlIiwiZ2V0U3RvcmFnZSIsImdldFNlcnZpY2VBY2NvdW50IiwicmF3IiwicHJvY2VzcyIsImVudiIsIkZJUkVCQVNFX0FETUlOX0pTT04iLCJ0eHQiLCJ0cmltIiwic3RhcnRzV2l0aCIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsIkpTT04iLCJwYXJzZSIsInByb2plY3RJZCIsIkZJUkVCQVNFX0FETUlOX1BST0pFQ1RfSUQiLCJjbGllbnRFbWFpbCIsIkZJUkVCQVNFX0FETUlOX0NMSUVOVF9FTUFJTCIsInByaXZhdGVLZXlSYXciLCJGSVJFQkFTRV9BRE1JTl9QUklWQVRFX0tFWSIsIkVycm9yIiwicHJpdmF0ZUtleSIsInJlcGxhY2UiLCJzdG9yYWdlQnVja2V0IiwiRklSRUJBU0VfQURNSU5fU1RPUkFHRV9CVUNLRVQiLCJhcHAiLCJsZW5ndGgiLCJjcmVkZW50aWFsIiwiYWRtaW5EYiIsImFkbWluU3RvcmFnZSIsImJ1Y2tldCIsImdsb2JhbEFueSIsImdsb2JhbFRoaXMiLCJmbGFnIiwic2V0dGluZ3MiLCJpZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/firebaseAdmin.ts\n");

/***/ }),

/***/ "(api)/./pages/api/auth/vscode/create-code.ts":
/*!**********************************************!*\
  !*** ./pages/api/auth/vscode/create-code.ts ***!
  \**********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase-admin/firestore */ \"firebase-admin/firestore\");\n/* harmony import */ var firebase_admin_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! firebase-admin/auth */ \"firebase-admin/auth\");\n/* harmony import */ var _lib_firebaseAdmin__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/firebaseAdmin */ \"(api)/./lib/firebaseAdmin.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__, firebase_admin_auth__WEBPACK_IMPORTED_MODULE_2__, _lib_firebaseAdmin__WEBPACK_IMPORTED_MODULE_3__]);\n([firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__, firebase_admin_auth__WEBPACK_IMPORTED_MODULE_2__, _lib_firebaseAdmin__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\nconst COLLECTION = \"vscode_auth_codes\";\nconst CODE_TTL_SECONDS = 10 * 60;\nconst ALPHABET = \"ABCDEFGHJKMNPQRSTVWXYZ23456789\";\nfunction sha256(input) {\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"sha256\").update(input).digest(\"hex\");\n}\nfunction generateCode() {\n    const bytes = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(10);\n    let out = \"\";\n    for(let i = 0; i < bytes.length; i += 1){\n        out += ALPHABET[bytes[i] % ALPHABET.length];\n    }\n    // 10 chars -> format MERSE-XXXXX-XXXXX\n    return `MERSE-${out.slice(0, 5)}-${out.slice(5, 10)}`;\n}\nfunction extractBearer(req) {\n    const authHeader = Array.isArray(req.headers.authorization) ? req.headers.authorization[0] : req.headers.authorization || \"\";\n    if (typeof authHeader !== \"string\") return \"\";\n    return authHeader.replace(/Bearer\\s+/i, \"\").trim();\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        res.setHeader(\"Allow\", \"POST\");\n        return res.status(405).json({\n            ok: false,\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const token = extractBearer(req) || (typeof req.body?.token === \"string\" ? req.body.token.trim() : \"\");\n        if (!token) {\n            return res.status(401).json({\n                ok: false,\n                error: \"Missing Firebase token\"\n            });\n        }\n        const decoded = await (0,firebase_admin_auth__WEBPACK_IMPORTED_MODULE_2__.getAuth)().verifyIdToken(token);\n        const uid = decoded.uid;\n        const code = generateCode();\n        const codeHash = sha256(code);\n        const expiresAt = firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__.Timestamp.fromMillis(Date.now() + CODE_TTL_SECONDS * 1000);\n        await _lib_firebaseAdmin__WEBPACK_IMPORTED_MODULE_3__.adminDb.collection(COLLECTION).doc(codeHash).set({\n            uid,\n            codeHash,\n            createdAt: firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__.FieldValue.serverTimestamp(),\n            expiresAt,\n            usedAt: null,\n            userAgent: typeof req.headers[\"user-agent\"] === \"string\" ? req.headers[\"user-agent\"] : null\n        });\n        return res.status(200).json({\n            ok: true,\n            code,\n            expiresAt: expiresAt.toDate().toISOString()\n        });\n    } catch (error) {\n        console.error(\"Erro em /api/auth/vscode/create-code:\", error);\n        return res.status(500).json({\n            ok: false,\n            error: \"Server error\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYXV0aC92c2NvZGUvY3JlYXRlLWNvZGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQzRCO0FBQ3FDO0FBQ25CO0FBQ0E7QUFNOUMsTUFBTUssYUFBYTtBQUNuQixNQUFNQyxtQkFBbUIsS0FBSztBQUU5QixNQUFNQyxXQUFXO0FBRWpCLFNBQVNDLE9BQU9DLEtBQWE7SUFDM0IsT0FBT1Qsd0RBQWlCLENBQUMsVUFBVVcsTUFBTSxDQUFDRixPQUFPRyxNQUFNLENBQUM7QUFDMUQ7QUFFQSxTQUFTQztJQUNQLE1BQU1DLFFBQVFkLHlEQUFrQixDQUFDO0lBQ2pDLElBQUlnQixNQUFNO0lBQ1YsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlILE1BQU1JLE1BQU0sRUFBRUQsS0FBSyxFQUFHO1FBQ3hDRCxPQUFPVCxRQUFRLENBQUNPLEtBQUssQ0FBQ0csRUFBRSxHQUFHVixTQUFTVyxNQUFNLENBQUM7SUFDN0M7SUFDQSx1Q0FBdUM7SUFDdkMsT0FBTyxDQUFDLE1BQU0sRUFBRUYsSUFBSUcsS0FBSyxDQUFDLEdBQUcsR0FBRyxDQUFDLEVBQUVILElBQUlHLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQztBQUN2RDtBQUVBLFNBQVNDLGNBQWNDLEdBQW1CO0lBQ3hDLE1BQU1DLGFBQWFDLE1BQU1DLE9BQU8sQ0FBQ0gsSUFBSUksT0FBTyxDQUFDQyxhQUFhLElBQ3RETCxJQUFJSSxPQUFPLENBQUNDLGFBQWEsQ0FBQyxFQUFFLEdBQzVCTCxJQUFJSSxPQUFPLENBQUNDLGFBQWEsSUFBSTtJQUNqQyxJQUFJLE9BQU9KLGVBQWUsVUFBVSxPQUFPO0lBQzNDLE9BQU9BLFdBQVdLLE9BQU8sQ0FBQyxjQUFjLElBQUlDLElBQUk7QUFDbEQ7QUFFZSxlQUFlQyxRQUM1QlIsR0FBbUIsRUFDbkJTLEdBQXdDO0lBRXhDLElBQUlULElBQUlVLE1BQU0sS0FBSyxRQUFRO1FBQ3pCRCxJQUFJRSxTQUFTLENBQUMsU0FBUztRQUN2QixPQUFPRixJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLElBQUk7WUFBT0MsT0FBTztRQUFxQjtJQUN2RTtJQUVBLElBQUk7UUFDRixNQUFNQyxRQUNKakIsY0FBY0MsUUFDYixRQUFRQSxJQUFJaUIsSUFBSSxFQUFVRCxVQUFVLFdBQVcsSUFBS0MsSUFBSSxDQUFTRCxLQUFLLENBQUNULElBQUksS0FBSyxFQUFDO1FBRXBGLElBQUksQ0FBQ1MsT0FBTztZQUNWLE9BQU9QLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLElBQUk7Z0JBQU9DLE9BQU87WUFBeUI7UUFDM0U7UUFFQSxNQUFNRyxVQUFVLE1BQU1wQyw0REFBT0EsR0FBR3FDLGFBQWEsQ0FBQ0g7UUFDOUMsTUFBTUksTUFBTUYsUUFBUUUsR0FBRztRQUV2QixNQUFNQyxPQUFPN0I7UUFDYixNQUFNOEIsV0FBV25DLE9BQU9rQztRQUN4QixNQUFNRSxZQUFZMUMsK0RBQVNBLENBQUMyQyxVQUFVLENBQUNDLEtBQUtDLEdBQUcsS0FBS3pDLG1CQUFtQjtRQUV2RSxNQUFNRix1REFBT0EsQ0FBQzRDLFVBQVUsQ0FBQzNDLFlBQVk0QyxHQUFHLENBQUNOLFVBQVVPLEdBQUcsQ0FBQztZQUNyRFQ7WUFDQUU7WUFDQVEsV0FBV2xELGdFQUFVQSxDQUFDbUQsZUFBZTtZQUNyQ1I7WUFDQVMsUUFBUTtZQUNSQyxXQUFXLE9BQU9qQyxJQUFJSSxPQUFPLENBQUMsYUFBYSxLQUFLLFdBQVdKLElBQUlJLE9BQU8sQ0FBQyxhQUFhLEdBQUc7UUFDekY7UUFFQSxPQUFPSyxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLElBQUk7WUFBTU87WUFBTUUsV0FBV0EsVUFBVVcsTUFBTSxHQUFHQyxXQUFXO1FBQUc7SUFDNUYsRUFBRSxPQUFPcEIsT0FBTztRQUNkcUIsUUFBUXJCLEtBQUssQ0FBQyx5Q0FBeUNBO1FBQ3ZELE9BQU9OLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsSUFBSTtZQUFPQyxPQUFPO1FBQWU7SUFDakU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21lcnNlZS8uL3BhZ2VzL2FwaS9hdXRoL3ZzY29kZS9jcmVhdGUtY29kZS50cz85ZWUzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgY3J5cHRvIGZyb20gXCJjcnlwdG9cIjtcbmltcG9ydCB7IEZpZWxkVmFsdWUsIFRpbWVzdGFtcCB9IGZyb20gXCJmaXJlYmFzZS1hZG1pbi9maXJlc3RvcmVcIjtcbmltcG9ydCB7IGdldEF1dGggfSBmcm9tIFwiZmlyZWJhc2UtYWRtaW4vYXV0aFwiO1xuaW1wb3J0IHsgYWRtaW5EYiB9IGZyb20gXCJAL2xpYi9maXJlYmFzZUFkbWluXCI7XG5cbnR5cGUgQ3JlYXRlQ29kZVJlc3BvbnNlID1cbiAgfCB7IG9rOiB0cnVlOyBjb2RlOiBzdHJpbmc7IGV4cGlyZXNBdDogc3RyaW5nIH1cbiAgfCB7IG9rOiBmYWxzZTsgZXJyb3I6IHN0cmluZyB9O1xuXG5jb25zdCBDT0xMRUNUSU9OID0gXCJ2c2NvZGVfYXV0aF9jb2Rlc1wiO1xuY29uc3QgQ09ERV9UVExfU0VDT05EUyA9IDEwICogNjA7XG5cbmNvbnN0IEFMUEhBQkVUID0gXCJBQkNERUZHSEpLTU5QUVJTVFZXWFlaMjM0NTY3ODlcIjtcblxuZnVuY3Rpb24gc2hhMjU2KGlucHV0OiBzdHJpbmcpIHtcbiAgcmV0dXJuIGNyeXB0by5jcmVhdGVIYXNoKFwic2hhMjU2XCIpLnVwZGF0ZShpbnB1dCkuZGlnZXN0KFwiaGV4XCIpO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUNvZGUoKSB7XG4gIGNvbnN0IGJ5dGVzID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDEwKTtcbiAgbGV0IG91dCA9IFwiXCI7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBvdXQgKz0gQUxQSEFCRVRbYnl0ZXNbaV0gJSBBTFBIQUJFVC5sZW5ndGhdO1xuICB9XG4gIC8vIDEwIGNoYXJzIC0+IGZvcm1hdCBNRVJTRS1YWFhYWC1YWFhYWFxuICByZXR1cm4gYE1FUlNFLSR7b3V0LnNsaWNlKDAsIDUpfS0ke291dC5zbGljZSg1LCAxMCl9YDtcbn1cblxuZnVuY3Rpb24gZXh0cmFjdEJlYXJlcihyZXE6IE5leHRBcGlSZXF1ZXN0KSB7XG4gIGNvbnN0IGF1dGhIZWFkZXIgPSBBcnJheS5pc0FycmF5KHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24pXG4gICAgPyByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uWzBdXG4gICAgOiByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uIHx8IFwiXCI7XG4gIGlmICh0eXBlb2YgYXV0aEhlYWRlciAhPT0gXCJzdHJpbmdcIikgcmV0dXJuIFwiXCI7XG4gIHJldHVybiBhdXRoSGVhZGVyLnJlcGxhY2UoL0JlYXJlclxccysvaSwgXCJcIikudHJpbSgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZTxDcmVhdGVDb2RlUmVzcG9uc2U+LFxuKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSBcIlBPU1RcIikge1xuICAgIHJlcy5zZXRIZWFkZXIoXCJBbGxvd1wiLCBcIlBPU1RcIik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJNZXRob2Qgbm90IGFsbG93ZWRcIiB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgdG9rZW4gPVxuICAgICAgZXh0cmFjdEJlYXJlcihyZXEpIHx8XG4gICAgICAodHlwZW9mIChyZXEuYm9keSBhcyBhbnkpPy50b2tlbiA9PT0gXCJzdHJpbmdcIiA/IChyZXEuYm9keSBhcyBhbnkpLnRva2VuLnRyaW0oKSA6IFwiXCIpO1xuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJNaXNzaW5nIEZpcmViYXNlIHRva2VuXCIgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgZGVjb2RlZCA9IGF3YWl0IGdldEF1dGgoKS52ZXJpZnlJZFRva2VuKHRva2VuKTtcbiAgICBjb25zdCB1aWQgPSBkZWNvZGVkLnVpZDtcblxuICAgIGNvbnN0IGNvZGUgPSBnZW5lcmF0ZUNvZGUoKTtcbiAgICBjb25zdCBjb2RlSGFzaCA9IHNoYTI1Nihjb2RlKTtcbiAgICBjb25zdCBleHBpcmVzQXQgPSBUaW1lc3RhbXAuZnJvbU1pbGxpcyhEYXRlLm5vdygpICsgQ09ERV9UVExfU0VDT05EUyAqIDEwMDApO1xuXG4gICAgYXdhaXQgYWRtaW5EYi5jb2xsZWN0aW9uKENPTExFQ1RJT04pLmRvYyhjb2RlSGFzaCkuc2V0KHtcbiAgICAgIHVpZCxcbiAgICAgIGNvZGVIYXNoLFxuICAgICAgY3JlYXRlZEF0OiBGaWVsZFZhbHVlLnNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgZXhwaXJlc0F0LFxuICAgICAgdXNlZEF0OiBudWxsLFxuICAgICAgdXNlckFnZW50OiB0eXBlb2YgcmVxLmhlYWRlcnNbXCJ1c2VyLWFnZW50XCJdID09PSBcInN0cmluZ1wiID8gcmVxLmhlYWRlcnNbXCJ1c2VyLWFnZW50XCJdIDogbnVsbCxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IG9rOiB0cnVlLCBjb2RlLCBleHBpcmVzQXQ6IGV4cGlyZXNBdC50b0RhdGUoKS50b0lTT1N0cmluZygpIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvIGVtIC9hcGkvYXV0aC92c2NvZGUvY3JlYXRlLWNvZGU6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiBcIlNlcnZlciBlcnJvclwiIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiRmllbGRWYWx1ZSIsIlRpbWVzdGFtcCIsImdldEF1dGgiLCJhZG1pbkRiIiwiQ09MTEVDVElPTiIsIkNPREVfVFRMX1NFQ09ORFMiLCJBTFBIQUJFVCIsInNoYTI1NiIsImlucHV0IiwiY3JlYXRlSGFzaCIsInVwZGF0ZSIsImRpZ2VzdCIsImdlbmVyYXRlQ29kZSIsImJ5dGVzIiwicmFuZG9tQnl0ZXMiLCJvdXQiLCJpIiwibGVuZ3RoIiwic2xpY2UiLCJleHRyYWN0QmVhcmVyIiwicmVxIiwiYXV0aEhlYWRlciIsIkFycmF5IiwiaXNBcnJheSIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwicmVwbGFjZSIsInRyaW0iLCJoYW5kbGVyIiwicmVzIiwibWV0aG9kIiwic2V0SGVhZGVyIiwic3RhdHVzIiwianNvbiIsIm9rIiwiZXJyb3IiLCJ0b2tlbiIsImJvZHkiLCJkZWNvZGVkIiwidmVyaWZ5SWRUb2tlbiIsInVpZCIsImNvZGUiLCJjb2RlSGFzaCIsImV4cGlyZXNBdCIsImZyb21NaWxsaXMiLCJEYXRlIiwibm93IiwiY29sbGVjdGlvbiIsImRvYyIsInNldCIsImNyZWF0ZWRBdCIsInNlcnZlclRpbWVzdGFtcCIsInVzZWRBdCIsInVzZXJBZ2VudCIsInRvRGF0ZSIsInRvSVNPU3RyaW5nIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/auth/vscode/create-code.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fvscode%2Fcreate-code&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fvscode%2Fcreate-code.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();